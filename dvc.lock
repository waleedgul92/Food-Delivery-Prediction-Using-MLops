schema: '2.0'
stages:
  data_ingestion:
    cmd: python src/data_ingestion.py
    deps:
    - path: data/raw/dataset.csv
      hash: md5
      md5: 20f163e082754da11f7eab4acdd7ddde
      size: 44200
    - path: src/data_ingestion.py
      hash: md5
      md5: 1d5996d9f80de8855ba4cc018a2c9ad8
      size: 2294
    params:
      params.yaml:
        base.random_state: 42
        data_split.test_size: 0.2
    outs:
    - path: data/interim
      hash: md5
      md5: 2fa80f79c9d29d7ae67ddf4915ae668f.dir
      size: 45332
      nfiles: 2
  data_processing:
    cmd: python src/data_process.py
    deps:
    - path: data/interim
      hash: md5
      md5: 2fa80f79c9d29d7ae67ddf4915ae668f.dir
      size: 45332
      nfiles: 2
    - path: src/data_process.py
      hash: md5
      md5: ceb0359b04ef9e749cd99d162d62b981
      size: 5640
    params:
      params.yaml:
        base.random_state: 42
        data_process.contamination: 0.1
    outs:
    - path: data/processed
      hash: md5
      md5: a60c896a2585b2e1e1839cbcb302f204.dir
      size: 42704
      nfiles: 2
    - path: src/visualization
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
  feature_engineering:
    cmd: python src/feature_engineering.py
    deps:
    - path: data/processed
      hash: md5
      md5: a60c896a2585b2e1e1839cbcb302f204.dir
      size: 42704
      nfiles: 2
    - path: src/feature_engineering.py
      hash: md5
      md5: d95092a4b50d3b13c10f28d736c58d3e
      size: 3705
    params:
      params.yaml:
        base.target_col: Delivery_Time_Minutes
    outs:
    - path: data/featured
      hash: md5
      md5: fcfcbc6fae8c7fbdb641fb7189c32592.dir
      size: 73278
      nfiles: 2
  train_model:
    cmd: python src/train_data.py
    deps:
    - path: data/featured
      hash: md5
      md5: fcfcbc6fae8c7fbdb641fb7189c32592.dir
      size: 73278
      nfiles: 2
    - path: src/train_data.py
      hash: md5
      md5: 0757b56822d5030504d69441f4114092
      size: 5927
    params:
      params.yaml:
        base:
          random_state: 42
          target_col: Delivery_Time_Minutes
        baseline_params:
          RandomForestRegressor:
            n_estimators: 100
            n_jobs: -1
          XGBRegressor:
            objective: reg:squarederror
            n_jobs: -1
        train:
          n_trials: 30
          cv_folds: 3
          model_name: artifacts/best_delivery_time_model.joblib
          hpo:
            GradientBoostingRegressor:
              n_estimators:
                type: int
                args:
                - 50
                - 500
              max_depth:
                type: int
                args:
                - 3
                - 12
              learning_rate:
                type: float
                args:
                - 0.01
                - 0.3
                log: true
              min_samples_split:
                type: int
                args:
                - 2
                - 20
              min_samples_leaf:
                type: int
                args:
                - 1
                - 20
              subsample:
                type: float
                args:
                - 0.6
                - 1.0
            RandomForestRegressor:
              n_estimators:
                type: int
                args:
                - 50
                - 500
              max_depth:
                type: int
                args:
                - 3
                - 30
              min_samples_split:
                type: int
                args:
                - 2
                - 20
              min_samples_leaf:
                type: int
                args:
                - 1
                - 20
              max_features:
                type: categorical
                args:
                - sqrt
                - log2
            XGBRegressor:
              n_estimators:
                type: int
                args:
                - 50
                - 500
              max_depth:
                type: int
                args:
                - 3
                - 12
              learning_rate:
                type: float
                args:
                - 0.01
                - 0.3
                log: true
              subsample:
                type: float
                args:
                - 0.6
                - 1.0
              colsample_bytree:
                type: float
                args:
                - 0.6
                - 1.0
              gamma:
                type: float
                args:
                - 0
                - 5
            DecisionTreeRegressor:
              max_depth:
                type: int
                args:
                - 3
                - 30
              min_samples_split:
                type: int
                args:
                - 2
                - 20
              min_samples_leaf:
                type: int
                args:
                - 1
                - 20
              criterion:
                type: categorical
                args:
                - squared_error
                - friedman_mse
                - absolute_error
  evaluate_model:
    cmd: python src/test_data.py
    deps:
    - path: data/featured
      hash: md5
      md5: fcfcbc6fae8c7fbdb641fb7189c32592.dir
      size: 73278
      nfiles: 2
    - path: src/test_data.py
      hash: md5
      md5: 959b5d2481409ae7f8262f6667e1e178
      size: 5395
    params:
      params.yaml:
        base.target_col: Delivery_Time_Minutes
        evaluate.predictions_csv: data/results/predictions.csv
        train.model_name: artifacts/best_delivery_time_model.joblib
    outs:
    - path: data/results/predictions.csv
      hash: md5
      md5: ed253ac04159bad8897207b51da06a3b
      size: 4850
